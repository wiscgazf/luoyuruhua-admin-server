webpackJsonp([18],{k7j2:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("ZPfm"),o=a("PJh5"),i=a.n(o),l={name:"ReplyMain",data:function(){return{tableData:[],showText:!0,title:"",timeout:null,timeout1:null,noData:"",currentPage:1,totalCount:1,showCount:15,loading:!0,pickerOptions2:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},dataRange:[],channelId:0,channelType:[{id:0,name:"随笔"},{id:1,name:"作品集"},{id:2,name:"相册"},{id:3,name:"音乐"},{id:4,name:"关于"},{id:5,name:"留言"}]}},components:{BreadCrumb:n.a},mounted:function(){this.commentData()},methods:{getCommentFun:function(t){var e=t.data.Data;if(this.totalCount=t.data.total,e){for(var a=0;a<e.length;a++)e[a].replyData.createTime=i()(e[a].replyData.createTime).format("YYYY-MM-DD HH:mm:ss"),e[a].status=this.channelType[e[a].status].name,e[a].replyData.from||(e[a].replyData.from={name:"没有评论对象"});this.tableData=e,this.loading=!1}else this.tableData=[],this.loading=!1,this.noData="没有找到合适的资源"},linkToEdit:function(t){alert("该功能暂未开放")},selectionChange:function(t){console.log(t)},handleSizeChange:function(t){this.showCount=t,this.commentData()},handleCurrentChange:function(t){this.currentPage=t,this.commentData()},delComment:function(t,e,a,n,o){var i=this;this.$http({method:"get",url:"/authPermission",params:{name:this.cookie.getCookie("user")}}).then(function(l){"auth"==l.data.isAuth?i.delCommentFun(t,e,a,n,o):i.$notify({title:"警告",message:"权限不足，无法进行相应操作！",type:"warning"})}).catch(function(t){i.$message({message:"获取权限异常，请联系管理员！",type:"error"}),console.log(t)})},delCommentFun:function(t,e,a,n,o){var i=this;this.$confirm("确认是否要删除该条评论","删除评论",{distinguishCancelAndClose:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then(function(){i.$http({method:"delete",url:"/deleteComment",data:{commentId:t,commentChildId:e,articleID:a,channelId:n,userId:o}}).then(function(t){1==t.data.msg?(i.$message({title:"成功",message:t.data.des,type:"success"}),i.commentData()):i.$message({title:"警告",message:t.data.des,type:"warning"})}).catch(function(t){i.$message({title:"失败",message:"删除评论失败，请联系管理员！",type:"error"}),console.log(t)})}).catch(function(t){i.$message({type:"info",message:"已取消"})})},onPick:function(t){this.dataRange=t},selectChannelType:function(t){this.commentData()},commentData:function(){var t=this;this.$http({method:"get",url:"/getCommentData",params:{channelId:this.channelId,dataTime:this.dataRange,currentPage:this.currentPage,showCount:this.showCount}}).then(function(e){t.getCommentFun(e)}).catch(function(e){t.$message({title:"失败",message:"获取评论失败，请联系管理员！",type:"error"}),console.log(e)})}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("gemini-scrollbar",{staticClass:"my-scroll-bar"},[a("bread-crumb"),t._v(" "),a("div",{staticClass:"find_admin"},[a("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:function(e){t.selectChannelType()}},model:{value:t.channelId,callback:function(e){t.channelId=e},expression:"channelId"}},t._l(t.channelType,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),t._v(" "),a("el-date-picker",{staticStyle:{"margin-left":"20px"},attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small","picker-options":t.pickerOptions2},on:{change:function(e){t.onPick(e)}},model:{value:t.dataRange,callback:function(e){t.dataRange=e},expression:"dataRange"}}),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:function(e){t.commentData()}}},[t._v("搜索")])],1),t._v(" "),a("div",{staticClass:"admin_list"},[t.tableData.length>0?[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",stripe:"","row-key":t.tableData._id,fit:"","highlight-current-row":""},on:{"selection-change":t.selectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"评论时间","show-overflow-tooltip":t.showText},scopedSlots:t._u([{key:"default",fn:function(e){return[a("i",{staticClass:"el-icon-time"}),t._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.replyData.createTime))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"replyData.to.name",label:"评论者"}}),t._v(" "),a("el-table-column",{attrs:{prop:"replyData.from.name",label:"评论对象"}}),t._v(" "),a("el-table-column",{attrs:{prop:"replyData.content",label:"评论内容","show-overflow-tooltip":t.showText}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"评论类别","show-overflow-tooltip":t.showText}}),t._v(" "),a("el-table-column",{attrs:{prop:"notesData.title",label:"类别标题","show-overflow-tooltip":t.showText}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){t.linkToEdit()}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.delComment(e.row._id,e.row.replyData._id,e.row.notesData._id,t.channelId,e.row.replyData.to._id)}}},[t._v("\n              移除\n            ")])]}}])})],1)]:[a("p",[t._v(t._s(t.noData))])],t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-sizes":[15,25,35,50],"page-size":100,layout:"total, sizes, prev, pager, next, jumper",total:t.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],2)],1)},staticRenderFns:[]};var r=a("VU/8")(l,s,!1,function(t){a("u1wr")},"data-v-02215e41",null);e.default=r.exports},u1wr:function(t,e){}});
//# sourceMappingURL=18.8d7df300c60460ddd83c.js.map