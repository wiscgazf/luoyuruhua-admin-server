webpackJsonp([5],{rkJb:function(t,e){},tRqb:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("ZPfm"),i=a("2pzT"),r={name:"AddNotes",components:{BreadCrumb:o.a,UE:i.a},data:function(){return{loading:!1,config:{initialFrameWidth:1200,initialFrameHeight:1200,autoFloatEnabled:!1,scaleEnabled:!0},form:{title:"",category:"",tag:[],thumbImg:a("Zebw"),description:"",content:"请编写您的随笔 . . ."},rules:{title:[{required:!0,message:"请输入随笔标题",trigger:"blur"}],category:[{required:!0,message:"请选择随笔类别",trigger:"change"}],description:[{required:!0,message:"请输入随笔概要",trigger:"blur"}]}}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return e.$notify({title:"警告",message:"请完善所需要的信息！",type:"warning"}),!1;e.addNotes()})},cancel:function(){this.$router.push({name:"NotesMain"})},changeImg:function(t){var e=this,a=t.target.files,o=new Image;if(a.length>0)var i=0,r=setInterval(function(){if("image/png"!=a.item(i).type&&"image/jpeg"!=a.item(i).type&&"image/gif"!=a.item(i).type)return!1;a.item(i).size>2048e3?e.$notify({title:"警告",message:"图片大小不得超过2MB",type:"error"}):(e.loading=!0,o.src=window.URL.createObjectURL(a.item(i)),o.onload=function(){var t=o.width,a=o.height,i=document.createElement("canvas"),r=i.getContext("2d"),l=document.createAttribute("width");l.nodeValue=t;var n=document.createAttribute("height");n.nodeValue=a,i.setAttributeNode(l),i.setAttributeNode(n),r.drawImage(o,0,0,t,a);var s=o.src.substring(o.src.lastIndexOf(".")+1).toLowerCase(),c=i.toDataURL("image/"+s,.8);e.uploadThumbImg(c),e.url=""}),i<a.length-1?i++:clearInterval(r)},1e3)},uploadThumbImg:function(t){var e=this;this.$http({method:"post",url:"/addthumbImg",data:{thumbImg:t}}).then(function(t){e.$message({message:"上传成功",type:"success"}),e.loading=!1,e.form.thumbImg=t.data.thumbImg}).catch(function(t){e.loading=!1,e.$message.error("上传失败，请联系管理员！"),console.log(t)})},selectTag:function(t){this.form.tag=t},selectCategory:function(t){this.form.category=t},addNotes:function(){var t=this;this.form.content=this.$refs.ue.getUEContent(),this.$http({method:"post",url:"/addNotes",data:{name:this.cookie.getCookie("user"),form:this.form}}).then(function(e){"200"==e.data.code&&(t.$notify({title:"成功",message:"添加成功",type:"success"}),t.$router.push({name:"NotesMain"}))}).catch(function(e){t.$notify.error({title:"错误",message:"请联系管理员"}),console.log(e)})}},mounted:function(){}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("GeminiScrollbar",[a("bread-crumb"),t._v(" "),a("div",{staticClass:"add_notes"},[a("el-form",{ref:"form",attrs:{rules:t.rules,model:t.form,"label-width":"100px"}},[a("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"随笔标题",prop:"title"}},[a("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"随笔分类",prop:"category"}},[a("el-select",{attrs:{placeholder:"请选择类别"},on:{change:function(e){t.selectCategory(e)}},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}},[a("el-option",{attrs:{label:"css",value:"css"}}),t._v(" "),a("el-option",{attrs:{label:"javascript",value:"javascript"}}),t._v(" "),a("el-option",{attrs:{label:"jquery",value:"jquery"}}),t._v(" "),a("el-option",{attrs:{label:"vue",value:"vue"}}),t._v(" "),a("el-option",{attrs:{label:"nodeJS",value:"nodeJS"}}),t._v(" "),a("el-option",{attrs:{label:"移动端",value:"移动端"}}),t._v(" "),a("el-option",{attrs:{label:"微信小程序",value:"微信小程序"}}),t._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"自定义标签"}},[a("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择文章标签"},on:{change:function(e){t.selectTag(e)}},model:{value:t.form.tag,callback:function(e){t.$set(t.form,"tag",e)},expression:"form.tag"}},[a("el-option",{attrs:{label:"css",value:"css"}}),t._v(" "),a("el-option",{attrs:{label:"javascript",value:"javascript"}}),t._v(" "),a("el-option",{attrs:{label:"jquery",value:"jquery"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"缩略图"}},[a("div",{staticClass:"com-upload-img"},[a("div",{staticClass:"img_group"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"img_box",attrs:{id:"show_upload","element-loading-text":"上传中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("img",{attrs:{src:t.form.thumbImg,alt:""}}),t._v(" "),a("div",{staticClass:"filter"},[t._v("\n                上传\n                "),a("input",{attrs:{type:"file",accept:"image/*"},on:{change:function(e){t.changeImg(e)}}})])])])])]),t._v(" "),a("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"简单概要",prop:"description"}},[a("el-input",{attrs:{type:"textarea",rows:"6",placeholder:"建议50到200字符"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"随笔内容"}}),t._v(" "),a("div",{staticClass:"editor-container"},[a("UE",{ref:"ue",attrs:{content:t.form.content,config:t.config}})],1),t._v(" "),a("el-form-item",{staticClass:"notes_btm",attrs:{align:"left"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("form")}}},[t._v("立即创建")]),t._v(" "),a("el-button",{on:{click:function(e){t.cancel()}}},[t._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var n=a("VU/8")(r,l,!1,function(t){a("rkJb")},"data-v-e4c976aa",null);e.default=n.exports}});
//# sourceMappingURL=5.2c6a658311a0b1299c4b.js.map