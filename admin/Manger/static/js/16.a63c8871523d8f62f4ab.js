webpackJsonp([16],{"9ub5":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("ZPfm"),l=a("2pzT"),r={name:"AddShowReel",components:{BreadCrumb:o.a,UE:l.a},data:function(){return{loading:!1,config:{initialFrameWidth:1200,initialFrameHeight:1200,autoFloatEnabled:!1,scaleEnabled:!0},form:{title:"",category:"",tecTag:[],thumbImg:a("Zebw"),content:"请简单叙述您的作品 . . .",showreelUrl:""},rules:{title:[{required:!0,message:"请输入作品名称",trigger:"blur"}],category:[{required:!0,message:"请选择作品类别",trigger:"change"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$notify({title:"警告",message:"请完善所需要的信息！",type:"warning"}),!1;t.addShowreel()})},cancel:function(){this.$router.push({name:"NotesMain"})},changeImg:function(e){var t=this,a=e.target.files,o=new Image;if(a.length>0)var l=0,r=setInterval(function(){if("image/png"!=a.item(l).type&&"image/jpeg"!=a.item(l).type&&"image/gif"!=a.item(l).type)return!1;a.item(l).size>2048e3?t.$notify({title:"警告",message:"图片大小不得超过2MB",type:"error"}):(t.loading=!0,o.src=window.URL.createObjectURL(a.item(l)),o.onload=function(){var e=o.width,a=o.height,l=document.createElement("canvas"),r=l.getContext("2d"),i=document.createAttribute("width");i.nodeValue=e;var n=document.createAttribute("height");n.nodeValue=a,l.setAttributeNode(i),l.setAttributeNode(n),r.drawImage(o,0,0,e,a);var s=o.src.substring(o.src.lastIndexOf(".")+1).toLowerCase(),c=l.toDataURL("image/"+s,.8);t.uploadThumbImg(c),t.url=""}),l<a.length-1?l++:clearInterval(r)},1e3)},uploadThumbImg:function(e){var t=this;this.$http({method:"post",url:"/addShowreelImg",data:{thumbImg:e}}).then(function(e){t.$message({message:"上传成功",type:"success"}),t.loading=!1,t.form.thumbImg=e.data.thumbImg}).catch(function(e){t.loading=!1,t.$message.error("上传失败，请联系管理员！"),console.log(e)})},selectTag:function(e){this.form.tecTag=e},selectCategory:function(e){this.form.category=e},addShowreel:function(){var e=this;this.form.content=this.$refs.ue.getUEContent(),this.$http({method:"post",url:"/addShowreel",data:{form:this.form}}).then(function(t){"200"==t.data.code&&(e.$notify({title:"成功",message:"添加成功",type:"success"}),e.$router.push({name:"ShowReel"}))}).catch(function(t){e.$notify.error({title:"错误",message:"请联系管理员"}),console.log(t)})}},mounted:function(){}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("GeminiScrollbar",[a("bread-crumb"),e._v(" "),a("div",{staticClass:"add_notes"},[a("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"100px"}},[a("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"作品名称",prop:"title"}},[a("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"作品链接"}},[a("el-input",{model:{value:e.form.showreelUrl,callback:function(t){e.$set(e.form,"showreelUrl",t)},expression:"form.showreelUrl"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"作品分类",prop:"category"}},[a("el-select",{attrs:{placeholder:"请选择类别"},on:{change:function(t){e.selectCategory(t)}},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},[a("el-option",{attrs:{label:"H5",value:"H5"}}),e._v(" "),a("el-option",{attrs:{label:"PC",value:"PC"}}),e._v(" "),a("el-option",{attrs:{label:"Vue",value:"Vue"}}),e._v(" "),a("el-option",{attrs:{label:"nodeJS",value:"nodeJS"}}),e._v(" "),a("el-option",{attrs:{label:"微信小程序",value:"微信小程序"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"自定义标签"}},[a("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择文章标签"},on:{change:function(t){e.selectTag(t)}},model:{value:e.form.tecTag,callback:function(t){e.$set(e.form,"tecTag",t)},expression:"form.tecTag"}},[a("el-option",{attrs:{label:"css",value:"css"}}),e._v(" "),a("el-option",{attrs:{label:"javascript",value:"javascript"}}),e._v(" "),a("el-option",{attrs:{label:"jquery",value:"jquery"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"缩略图"}},[a("div",{staticClass:"com-upload-img"},[a("div",{staticClass:"img_group"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"img_box",attrs:{id:"show_upload","element-loading-text":"上传中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("img",{attrs:{src:e.form.thumbImg,alt:""}}),e._v(" "),a("div",{staticClass:"filter"},[e._v("\n                上传\n                "),a("input",{attrs:{type:"file",accept:"image/*"},on:{change:function(t){e.changeImg(t)}}})])])])])]),e._v(" "),a("el-form-item",{attrs:{label:"作品内容"}}),e._v(" "),a("div",{staticClass:"editor-container"},[a("UE",{ref:"ue",attrs:{content:e.form.content,config:e.config}})],1),e._v(" "),a("el-form-item",{staticClass:"notes_btm",attrs:{align:"left"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("立即创建")]),e._v(" "),a("el-button",{on:{click:function(t){e.cancel()}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var n=a("VU/8")(r,i,!1,function(e){a("rSZc")},"data-v-0d321282",null);t.default=n.exports},rSZc:function(e,t){}});
//# sourceMappingURL=16.a63c8871523d8f62f4ab.js.map